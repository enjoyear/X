@import _root_.com.chen.guo.models.valuation.AnalyzeRequest
@import _root_.com.chen.guo.models.valuation.AnalyzeDataSet
@import _root_.com.chen.guo.views.html.main
@import helper._
@import scala.collection.JavaConverters._

@(requestForm: Form[AnalyzeRequest], request: AnalyzeRequest, dataSet: AnalyzeDataSet)(implicit messages: Messages)

@displayTwoDigitsAfterPoint(number: Double) = @{
    math.rint(number * 100) / 100
}

@main("valuation") {
    <div class="page-header">
        <h1>Valuation</h1>
    </div>

    <div class="form-group">
    @form(com.chen.guo.controllers.valuation.routes.ValuationController.formPost) {
        @inputText(requestForm("name"), 'placeholder -> {
            if(request == AnalyzeRequest.emptyRequest)
                "Code/Name"
            else request.name
        }
            , '_label -> ""
        )
        <input type="submit" value="Analyze">
        }
    </div>

    <h2>
    @request.name
    </h2>
    <p>
        Net Income(Millions Yuan)
    </p>

    <div class="table-responsive" style="float: left;">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Year</th><th>Q1</th><th>Q2</th><th>Q3</th><th>Q4</th>
                </tr>
            </thead>

            <tbody>
            @for(yearMap <- dataSet.getYearMonthMap.asScala) {
                <tr>
                    <td>@yearMap._1</td>
                    @for(monthVal <- yearMap._2.asScala) {
                        <td>@displayTwoDigitsAfterPoint(monthVal._2 / 100000)</td>
                    }
                </tr>
            }
            </tbody>
        </table>
    </div>
}